{% extends 'base.html' %}
{% load static %}
{% load custom_filters %}
{% block content %}
<style>
:root {
    --glass-white: rgba(255, 255, 255, 0.95);
    --glass-light: rgba(255, 255, 255, 0.85);
    --glass-medium: rgba(255, 255, 255, 0.75);
    --glass-dark: rgba(255, 255, 255, 0.65);
    --glass-border: rgba(255, 255, 255, 0.25);
    --glass-shadow: 0 20px 40px rgba(0, 0, 0, 0.08);
    --text-primary: #2d3748;
    --text-secondary: #4a5568;
    --text-muted: #718096;
    --blur-intensity: blur(20px);
    --border-radius: 20px;
}

body {
    background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
    min-height: 100vh;
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
}

.create-listing-container {
    min-height: 80vh;
    padding: 30px 20px;
    max-width: 1200px;
    margin: 0 auto;
}

.listing-card {
    background: var(--glass-white);
    backdrop-filter: var(--blur-intensity);
    -webkit-backdrop-filter: var(--blur-intensity);
    border-radius: var(--border-radius);
    border: 1px solid var(--glass-border);
    box-shadow: var(--glass-shadow);
    overflow: hidden;
    animation: fadeIn 0.8s ease-out;
}

/* Success Message - Glassmorphism */
.alert-success-custom {
    background: var(--glass-white);
    backdrop-filter: blur(15px);
    border-radius: 16px;
    border: 1px solid var(--glass-border);
    margin-bottom: 30px;
    padding: 20px 25px;
    position: relative;
    overflow: hidden;
    box-shadow: var(--glass-shadow);
}

.alert-success-custom::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 4px;
    height: 100%;
    background: linear-gradient(to bottom, #48bb78, #38a169);
}

.alert-success-custom .alert-content {
    display: flex;
    align-items: center;
    gap: 20px;
}

.alert-success-custom .alert-icon {
    background: linear-gradient(135deg, #48bb78, #38a169);
    color: white;
    width: 48px;
    height: 48px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 22px;
    flex-shrink: 0;
    box-shadow: 0 4px 15px rgba(72, 187, 120, 0.2);
}

.alert-success-custom .alert-text {
    flex: 1;
}

.alert-success-custom .alert-title {
    margin: 0 0 8px 0;
    color: var(--text-primary);
    font-weight: 700;
    font-size: 18px;
}

.alert-success-custom .alert-message {
    margin: 0;
    color: var(--text-secondary);
}

.alert-success-custom .btn-close {
    position: absolute;
    top: 15px;
    right: 15px;
    background: var(--glass-medium);
    border: 1px solid var(--glass-border);
    width: 32px;
    height: 32px;
    border-radius: 50%;
    color: var(--text-muted);
    cursor: pointer;
    font-size: 18px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    backdrop-filter: blur(5px);
}

.alert-success-custom .btn-close:hover {
    background: var(--glass-dark);
    color: var(--text-primary);
    transform: rotate(90deg);
}

/* Progress Steps - Glassmorphism */
.progress-steps {
    padding: 25px 30px;
    background: var(--glass-light);
    border-bottom: 1px solid var(--glass-border);
    backdrop-filter: blur(10px);
}

.step-container {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: nowrap;
    position: relative;
}

.step {
    text-align: center;
    flex: 1;
    min-width: 0;
    position: relative;
    z-index: 2;
}

.step-number {
    background: var(--glass-white);
    backdrop-filter: blur(10px);
    color: var(--text-primary);
    width: 36px;
    height: 36px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 8px;
    font-weight: 700;
    font-size: 15px;
    border: 2px solid var(--glass-border);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
}

.step.active .step-number {
    background: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
    color: white;
    border-color: rgba(45, 55, 72, 0.3);
}

.step-label {
    font-size: 12px;
    color: var(--text-secondary);
    font-weight: 600;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.step.active .step-label {
    color: var(--text-primary);
    font-weight: 700;
}

.step-connector {
    flex: 1;
    height: 3px;
    background: var(--glass-border);
    margin: 0 10px;
    min-width: 30px;
    position: relative;
    overflow: hidden;
}

.step-connector::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, #2d3748, #4a5568);
    transform: scaleX(0);
    transform-origin: left;
    transition: transform 0.3s ease;
}

.step-connector.active::after {
    transform: scaleX(1);
}

/* Form Sections - Glassmorphism */
.form-section {
    margin-bottom: 35px;
    padding: 30px;
    background: var(--glass-light);
    border-radius: 16px;
    border: 1px solid var(--glass-border);
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.04);
}

.section-header {
    display: flex;
    align-items: center;
    margin-bottom: 25px;
    padding-bottom: 20px;
    border-bottom: 2px solid var(--glass-border);
}

.section-icon {
    background: var(--glass-white);
    backdrop-filter: blur(10px);
    width: 50px;
    height: 50px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 15px;
    color: var(--text-primary);
    font-size: 20px;
    border: 1px solid var(--glass-border);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
}

.section-content {
    min-width: 0;
}

.section-title {
    color: var(--text-primary);
    margin: 0 0 5px 0;
    font-weight: 700;
    font-size: 20px;
}

.section-subtitle {
    color: var(--text-secondary);
    margin: 0;
    font-size: 14px;
}

/* Form Controls - Glassmorphism */
.form-group {
    margin-bottom: 25px;
}

.form-label {
    display: block;
    margin-bottom: 10px;
    font-weight: 600;
    color: var(--text-primary);
    font-size: 15px;
}

.form-label i {
    margin-right: 8px;
    color: var(--text-secondary);
}

.required-star {
    color: #e53e3e;
    margin-left: 2px;
}

.form-control {
    width: 100%;
    padding: 14px 16px;
    background: var(--glass-white);
    backdrop-filter: blur(10px);
    border: 1px solid var(--glass-border);
    border-radius: 12px;
    font-size: 15px;
    color: var(--text-primary);
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.03);
}

.form-control::placeholder {
    color: var(--text-muted);
}

.form-control:focus {
    outline: none;
    background: var(--glass-white);
    border-color: rgba(148, 163, 184, 0.5);
    box-shadow:
        0 0 0 3px rgba(148, 163, 184, 0.1),
        0 4px 20px rgba(0, 0, 0, 0.08);
    transform: translateY(-2px);
}

.form-tip {
    display: flex;
    align-items: flex-start;
    gap: 10px;
    margin-top: 8px;
    padding: 12px;
    background: var(--glass-medium);
    border-radius: 8px;
    border-left: 3px solid rgba(148, 163, 184, 0.3);
}

.form-tip i {
    color: var(--text-secondary);
    font-size: 14px;
    margin-top: 2px;
    flex-shrink: 0;
}

.form-tip small {
    font-size: 13px;
    color: var(--text-secondary);
    line-height: 1.4;
}

/* Capacity Grid - Glassmorphism */
.capacity-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 15px;
    margin-bottom: 25px;
}

@media (min-width: 768px) {
    .capacity-grid {
        grid-template-columns: repeat(4, 1fr);
    }
}

.capacity-item {
    text-align: center;
    padding: 20px 15px;
    background: var(--glass-white);
    backdrop-filter: blur(10px);
    border-radius: 12px;
    border: 1px solid var(--glass-border);
    transition: all 0.3s ease;
}

.capacity-item:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
    border-color: rgba(148, 163, 184, 0.3);
}

.capacity-icon {
    color: var(--text-primary);
    font-size: 24px;
    margin-bottom: 12px;
}

.capacity-label {
    display: block;
    margin-bottom: 10px;
    font-weight: 600;
    color: var(--text-primary);
    font-size: 14px;
}

.capacity-input {
    background: var(--glass-light);
    border: 1px solid var(--glass-border);
    border-radius: 8px;
    padding: 10px;
    text-align: center;
    font-weight: 600;
    color: var(--text-primary);
    width: 100%;
    max-width: 120px;
    margin: 0 auto;
}

.capacity-input:focus {
    outline: none;
    border-color: rgba(148, 163, 184, 0.5);
    box-shadow: 0 0 0 3px rgba(148, 163, 184, 0.1);
}

/* Amenities Grid - Glassmorphism */
.amenities-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 15px;
}

.amenity-item {
    padding: 15px;
    background: var(--glass-white);
    backdrop-filter: blur(10px);
    border-radius: 12px;
    border: 1px solid var(--glass-border);
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 100%;
    transition: all 0.3s ease;
}

.amenity-item:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.06);
    border-color: rgba(148, 163, 184, 0.3);
}

.amenity-content {
    display: flex;
    align-items: center;
    gap: 12px;
    min-width: 0;
}

.amenity-icon {
    color: var(--text-primary);
    font-size: 18px;
    flex-shrink: 0;
}

.amenity-label {
    margin: 0;
    font-weight: 600;
    color: var(--text-primary);
    cursor: pointer;
    font-size: 14px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.amenity-checkbox {
    width: 20px;
    height: 20px;
    border: 2px solid var(--glass-border);
    border-radius: 6px;
    cursor: pointer;
    flex-shrink: 0;
}

.amenity-checkbox:checked {
    background: var(--text-primary);
    border-color: var(--text-primary);
}

/* Listing Type Cards - Glassmorphism */
.listing-type-grid {
    display: grid;
    grid-template-columns: repeat(1, 1fr);
    gap: 20px;
    margin-bottom: 30px;
}

@media (min-width: 768px) {
    .listing-type-grid {
        grid-template-columns: repeat(2, 1fr);
    }
}

.listing-card-option {
    border: 2px solid var(--glass-border);
    border-radius: 16px;
    padding: 25px;
    background: var(--glass-white);
    backdrop-filter: blur(15px);
    cursor: pointer;
    height: 100%;
    text-align: center;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
}

.listing-card-option:hover {
    transform: translateY(-5px);
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
    border-color: rgba(148, 163, 184, 0.3);
}

.listing-card-option.selected {
    border-color: var(--text-primary);
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
}

.featured-badge {
    position: absolute;
    top: 15px;
    right: -30px;
    background: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
    color: white;
    padding: 5px 35px;
    transform: rotate(45deg);
    font-size: 12px;
    font-weight: 700;
}

.card-icon {
    color: var(--text-primary);
    font-size: 42px;
    margin-bottom: 20px;
}

.card-title {
    color: var(--text-primary);
    margin-bottom: 15px;
    font-weight: 700;
    font-size: 18px;
}

.card-price {
    font-size: 32px;
    font-weight: 800;
    color: var(--text-primary);
    margin-bottom: 15px;
    background: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

.card-features {
    margin-bottom: 20px;
    text-align: left;
}

.card-features ul {
    padding-left: 20px;
    margin: 0;
    color: var(--text-secondary);
    font-size: 14px;
    line-height: 1.6;
}

.card-features li {
    margin-bottom: 8px;
}

.listing-radio {
    width: 20px;
    height: 20px;
    margin-right: 10px;
    cursor: pointer;
}

.listing-radio:checked {
    background: var(--text-primary);
    border-color: var(--text-primary);
}

/* Photo Upload - Glassmorphism */
.photo-tips {
    background: var(--glass-medium);
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 25px;
    border-left: 4px solid var(--glass-border);
}

.photo-tips-content {
    display: flex;
    align-items: flex-start;
    gap: 15px;
}

.photo-tips-icon {
    color: var(--text-primary);
    font-size: 20px;
    flex-shrink: 0;
}

.photo-tips-title {
    margin: 0 0 8px 0;
    color: var(--text-primary);
    font-weight: 600;
    font-size: 16px;
}

.photo-tips-list {
    margin: 0;
    padding-left: 20px;
    color: var(--text-secondary);
    font-size: 13px;
    line-height: 1.6;
}

.photo-tips-list li {
    margin-bottom: 6px;
}

.photo-upload-grid {
    display: grid;
    grid-template-columns: repeat(1, 1fr);
    gap: 20px;
    margin-bottom: 30px;
}

@media (min-width: 768px) {
    .photo-upload-grid {
        grid-template-columns: repeat(2, 1fr);
    }
}

.photo-upload-item {
    border: 2px dashed var(--glass-border);
    border-radius: 12px;
    padding: 25px;
    text-align: center;
    background: var(--glass-light);
    height: 100%;
    transition: all 0.3s ease;
    cursor: pointer;
}

.photo-upload-item:hover {
    border-color: rgba(148, 163, 184, 0.5);
    background: var(--glass-medium);
    transform: translateY(-3px);
}

.upload-icon {
    color: var(--text-primary);
    font-size: 32px;
    margin-bottom: 15px;
}

.upload-label {
    display: block;
    margin-bottom: 15px;
    font-weight: 600;
    color: var(--text-primary);
    cursor: pointer;
    font-size: 15px;
}

.upload-info {
    margin-top: 12px;
    font-size: 13px;
    color: var(--text-secondary);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
}

.upload-info i {
    color: var(--text-muted);
}

/* Pricing Input - Glassmorphism */
.price-input-container {
    display: flex;
    max-width: 300px;
    margin-bottom: 15px;
}

.price-prefix {
    background: var(--glass-white);
    color: var(--text-primary);
    border: 1px solid var(--glass-border);
    padding: 14px 18px;
    border-radius: 12px 0 0 12px;
    font-weight: 600;
    font-size: 15px;
    border-right: none;
}

.price-input {
    border-radius: 0 12px 12px 0;
    border-left: none;
}

/* Submit Section - Glassmorphism */
.submit-section {
    background: var(--glass-light);
    border-radius: 16px;
    padding: 30px;
    border: 1px solid var(--glass-border);
    margin-top: 40px;
}

.submit-header {
    text-align: center;
    margin-bottom: 25px;
}

.submit-title {
    color: var(--text-primary);
    margin: 0 0 10px 0;
    font-weight: 700;
    font-size: 22px;
}

.submit-subtitle {
    color: var(--text-secondary);
    margin: 0;
    font-size: 14px;
}

.submit-button {
    background: var(--glass-white);
    color: var(--text-primary);
    border: 1px solid var(--glass-border);
    padding: 18px 25px;
    border-radius: 12px;
    font-weight: 700;
    font-size: 17px;
    transition: all 0.3s ease;
    box-shadow: var(--glass-shadow);
    cursor: pointer;
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    backdrop-filter: blur(10px);
}

.submit-button:hover {
    background: var(--glass-white);
    transform: translateY(-3px);
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.12);
    border-color: rgba(148, 163, 184, 0.3);
}

.submit-button:active {
    transform: translateY(-1px);
}

.submit-note {
    text-align: center;
    margin-top: 15px;
}

.submit-note p {
    color: var(--text-secondary);
    font-size: 13px;
    margin: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
}

.submit-note i {
    color: var(--text-muted);
}

/* Error Messages - Glassmorphism */
.error-message {
    color: #e53e3e;
    font-size: 13px;
    margin-top: 8px;
    padding: 10px 15px;
    background: rgba(229, 62, 62, 0.05);
    border-radius: 8px;
    border-left: 3px solid #e53e3e;
    display: flex;
    align-items: center;
    gap: 10px;
}

.error-message i {
    font-size: 14px;
    flex-shrink: 0;
}

/* Animations */
@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(20px) scale(0.98);
    }
    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

/* Responsive Design */
@media (max-width: 768px) {
    .create-listing-container {
        padding: 20px 15px;
    }

    .listing-card {
        border-radius: 16px;
    }

    .form-section {
        padding: 20px;
    }

    .section-header {
        flex-direction: column;
        text-align: center;
        gap: 15px;
    }

    .section-icon {
        margin-right: 0;
    }

    .listing-type-grid {
        grid-template-columns: 1fr;
    }

    .photo-upload-grid {
        grid-template-columns: 1fr;
    }
}

@media (max-width: 480px) {
    .create-listing-container {
        padding: 15px 10px;
    }

    .step-number {
        width: 32px;
        height: 32px;
        font-size: 14px;
    }

    .step-label {
        font-size: 11px;
    }

    .form-section {
        padding: 15px;
    }

    .section-title {
        font-size: 18px;
    }

    .form-control {
        padding: 12px 14px;
    }

    .submit-button {
        padding: 16px 20px;
        font-size: 16px;
    }
}
</style>

<div class="create-listing-container">
    <div class="listing-card">
        <!-- Success Message -->
        {% if messages %}
            {% for message in messages %}
                <div class="alert-success-custom">
                    <div class="alert-content">
                        <div class="alert-icon">
                            <i class="fa fa-check"></i>
                        </div>
                        <div class="alert-text">
                            <h5 class="alert-title">Success!</h5>
                            <p class="alert-message">{{ message }}</p>
                        </div>
                    </div>
                    <button type="button" class="btn-close" data-bs-dismiss="alert">Ã—</button>
                </div>
            {% endfor %}
        {% endif %}

        <!-- Progress Steps -->
        <div class="progress-steps">
            <div class="step-container">
                <div class="step active">
                    <div class="step-number">1</div>
                    <div class="step-label">Property Info</div>
                </div>
                <div class="step-connector active"></div>
                <div class="step active">
                    <div class="step-number">2</div>
                    <div class="step-label">Details</div>
                </div>
                <div class="step-connector active"></div>
                <div class="step active">
                    <div class="step-number">3</div>
                    <div class="step-label">Pricing & Photos</div>
                </div>
            </div>
        </div>

        <!-- Form Body -->
        <div style="padding: 30px;">
            <form method="POST" enctype="multipart/form-data" novalidate>
                {% csrf_token %}

                <!-- Property Information Section -->
                <div class="form-section">
                    <div class="section-header">
                        <div class="section-icon">
                            <i class="fa fa-info-circle"></i>
                        </div>
                        <div class="section-content">
                            <h3 class="section-title">Property Information</h3>
                            <p class="section-subtitle">Tell us about your property</p>
                        </div>
                    </div>

                    <!-- Title -->
                    <div class="form-group">
                        <label class="form-label">
                            <i class="fa fa-pencil-alt"></i>
                            Property Name
                            <span class="required-star">*</span>
                        </label>
                        {{ form.title }}
                        <div class="form-tip">
                            <i class="fa fa-lightbulb"></i>
                            <small>Make it catchy! Example: "Beautiful 3-Bedroom Apartment with City View"</small>
                        </div>
                        {% if form.title.errors %}
                            <div class="error-message">
                                <i class="fa fa-exclamation-circle"></i>
                                {% for error in form.title.errors %}
                                    {{ error }}
                                {% endfor %}
                            </div>
                        {% endif %}
                    </div>

                    <!-- Property Type and Location -->
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fa fa-building"></i>
                                    Property Type
                                    <span class="required-star">*</span>
                                </label>
                                {{ form.property_type }}
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fa fa-map-marker-alt"></i>
                                    Location
                                    <span class="required-star">*</span>
                                </label>
                                {{ form.location }}
                            </div>
                        </div>
                    </div>

                    <!-- Specific Location -->
                    <div class="form-group">
                        <label class="form-label">
                            <i class="fa fa-map-pin"></i>
                            Specific Location
                            <span class="required-star">*</span>
                        </label>
                        {{ form.specific_location }}
                    </div>
                </div>

                <!-- Host Information Section -->
                <div class="form-section">
                    <div class="section-header">
                        <div class="section-icon">
                            <i class="fa fa-user"></i>
                        </div>
                        <div class="section-content">
                            <h3 class="section-title">Host Information</h3>
                            <p class="section-subtitle">How guests can contact you</p>
                        </div>
                    </div>

                    <!-- Host Name -->
                    <div class="form-group">
                        <label class="form-label">
                            <i class="fa fa-user-circle"></i>
                            Host Name
                            <span class="required-star">*</span>
                        </label>
                        {{ form.host_name }}
                    </div>

                    <!-- Phone Numbers -->
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fa fa-phone"></i>
                                    Phone Number
                                    <span class="required-star">*</span>
                                </label>
                                {{ form.host_phone }}
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fa fa-whatsapp"></i>
                                    WhatsApp
                                    <span class="required-star">*</span>
                                </label>
                                {{ form.host_whatsapp }}
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Property Details Section -->
                <div class="form-section">
                    <div class="section-header">
                        <div class="section-icon">
                            <i class="fa fa-bed"></i>
                        </div>
                        <div class="section-content">
                            <h3 class="section-title">Property Details</h3>
                            <p class="section-subtitle">Accommodation capacity and layout</p>
                        </div>
                    </div>

                    <!-- Capacity Grid -->
                    <div class="capacity-grid">
                        <div class="capacity-item">
                            <div class="capacity-icon">
                                <i class="fa fa-users"></i>
                            </div>
                            <label class="capacity-label">Guests</label>
                            {{ form.guests }}
                        </div>
                        <div class="capacity-item">
                            <div class="capacity-icon">
                                <i class="fa fa-door-closed"></i>
                            </div>
                            <label class="capacity-label">Bedrooms</label>
                            {{ form.bedrooms }}
                        </div>
                        <div class="capacity-item">
                            <div class="capacity-icon">
                                <i class="fa fa-bed"></i>
                            </div>
                            <label class="capacity-label">Beds</label>
                            {{ form.beds }}
                        </div>
                        <div class="capacity-item">
                            <div class="capacity-icon">
                                <i class="fa fa-bath"></i>
                            </div>
                            <label class="capacity-label">Bathrooms</label>
                            {{ form.bathrooms }}
                        </div>
                    </div>
                </div>

                <!-- Amenities Section -->
                <div class="form-section">
                    <div class="section-header">
                        <div class="section-icon">
                            <i class="fa fa-star"></i>
                        </div>
                        <div class="section-content">
                            <h3 class="section-title">Amenities & Features</h3>
                            <p class="section-subtitle">Select what your property offers</p>
                        </div>
                    </div>

                    <!-- Amenities Grid -->
                    <div class="amenities-grid">
                        {% for field_name in 'wifi parking kitchen pool ac tv'|split %}
                            {% with form|get_item:field_name as field %}
                                <div class="amenity-item">
                                    <div class="amenity-content">
                                        <div class="amenity-icon">
                                            {% if field_name == 'wifi' %}
                                                <i class="fa fa-wifi"></i>
                                            {% elif field_name == 'parking' %}
                                                <i class="fa fa-car"></i>
                                            {% elif field_name == 'kitchen' %}
                                                <i class="fa fa-utensils"></i>
                                            {% elif field_name == 'pool' %}
                                                <i class="fa fa-swimming-pool"></i>
                                            {% elif field_name == 'ac' %}
                                                <i class="fa fa-snowflake"></i>
                                            {% elif field_name == 'tv' %}
                                                <i class="fa fa-tv"></i>
                                            {% endif %}
                                        </div>
                                        <label class="amenity-label">{{ field.label }}</label>
                                    </div>
                                    {{ field }}
                                </div>
                            {% endwith %}
                        {% endfor %}
                    </div>
                </div>

                <!-- Listing Type Section -->
                <div class="form-section">
                    <div class="section-header">
                        <div class="section-icon">
                            <i class="fa fa-crown"></i>
                        </div>
                        <div class="section-content">
                            <h3 class="section-title">Listing Type</h3>
                            <p class="section-subtitle">Choose how you want to list your property</p>
                        </div>
                    </div>

                    <!-- Listing Options -->
                    <div class="listing-type-grid">
                        <div class="listing-card-option" id="free-listing-card">
                            <div class="card-icon">
                                <i class="fa fa-gift"></i>
                            </div>
                            <h5 class="card-title">Free Listing</h5>
                            <div class="card-price">KES 0</div>
                            <div class="card-features">
                                <ul>
                                    <li>Basic listing on the site</li>
                                    <li>10% PER BOOKING</li>
                                </ul>
                            </div>
                            <div>
                                <input class="listing-radio" type="radio" name="listing_type" id="id_listing_type_0" value="free" checked>
                                <label for="id_listing_type_0">Select Free Listing</label>
                            </div>
                        </div>
                        <div class="listing-card-option" id="featured-listing-card">
                            <div class="featured-badge">POPULAR</div>
                            <div class="card-icon">
                                <i class="fa fa-crown"></i>
                            </div>
                            <h5 class="card-title">Featured Listing</h5>
                            <div class="card-price">KES 1,000</div>
                            <div class="card-features">
                                <ul>
                                    <li><strong>Appears at the TOP</strong> of search results</li>
                                    <li><strong>10x more visibility</strong></li>
                                    <li>Higher booking conversion</li>
                                    <li>Social media ads & content</li>
                                </ul>
                            </div>
                            <div>
                                <input class="listing-radio" type="radio" name="listing_type" id="id_listing_type_1" value="featured">
                                <label for="id_listing_type_1">Select Featured Listing</label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Pricing Section -->
                <div class="form-section">
                    <div class="section-header">
                        <div class="section-icon">
                            <i class="fa fa-money-bill-wave"></i>
                        </div>
                        <div class="section-content">
                            <h3 class="section-title">Pricing</h3>
                            <p class="section-subtitle">Set your nightly rate</p>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">
                            <i class="fa fa-tag"></i>
                            Price per Night
                            <span class="required-star">*</span>
                        </label>
                        <div class="price-input-container">
                            <span class="price-prefix">KES</span>
                            {{ form.price_per_night }}
                        </div>
                        <div class="form-tip">
                            <i class="fa fa-chart-line"></i>
                            <small>Average nightly rate in this area: KES 5,000 - 15,000</small>
                        </div>
                    </div>
                </div>

                <!-- Images Section -->
                <div class="form-section">
                    <div class="section-header">
                        <div class="section-icon">
                            <i class="fa fa-images"></i>
                        </div>
                        <div class="section-content">
                            <h3 class="section-title">Property Photos</h3>
                            <p class="section-subtitle">High-quality photos attract more guests</p>
                        </div>
                    </div>

                    <!-- Photo Tips -->
                    <div class="photo-tips">
                        <div class="photo-tips-content">
                            <div class="photo-tips-icon">
                                <i class="fa fa-camera"></i>
                            </div>
                            <div>
                                <h5 class="photo-tips-title">Photo Tips</h5>
                                <ul class="photo-tips-list">
                                    <li>Use natural light for better quality</li>
                                    <li>Show all rooms and key features</li>
                                    <li>Keep images under 5MB each</li>
                                    <li>Upload at least 3 photos</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Image Uploads -->
                    <div class="photo-upload-grid">
                        {% for field_name in 'main_image image_2 image_3 image_4'|split %}
                            {% with form|get_item:field_name as field %}
                                <div class="photo-upload-item">
                                    <div class="upload-icon">
                                        {% if forloop.first %}
                                            <i class="fa fa-camera"></i>
                                        {% else %}
                                            <i class="fa fa-image"></i>
                                        {% endif %}
                                    </div>
                                    <label class="upload-label" for="{{ field.id_for_label }}">
                                        {{ field.label }}
                                        {% if forloop.first %}<span class="required-star">*</span>{% endif %}
                                    </label>
                                    {{ field }}
                                    <div class="upload-info">
                                        {% if forloop.first %}
                                            <i class="fa fa-star"></i>
                                            <span>Main photo (Required)</span>
                                        {% else %}
                                            <i class="fa fa-plus"></i>
                                            <span>Additional photo</span>
                                        {% endif %}
                                    </div>
                                </div>
                            {% endwith %}
                        {% endfor %}
                    </div>
                </div>

                <!-- Submit Section -->
                <div class="submit-section">
                    <div class="submit-header">
                        <h4 class="submit-title">Ready to List Your Property?</h4>
                        <p class="submit-subtitle">Review your information and submit when ready</p>
                    </div>

                    <div>
                        <button type="submit" id="submit-btn" class="submit-button">
                            <i class="fa fa-paper-plane"></i>
                            Submit Property Listing
                        </button>

                        <div class="submit-note">
                            <p>
                                <i class="fa fa-shield-alt"></i>
                                Your listing will be reviewed within 24 hours
                            </p>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const form = document.querySelector('form');
    const inputs = form.querySelectorAll('input, select, textarea');

    // Listing type selection
    const freeCard = document.getElementById('free-listing-card');
    const featuredCard = document.getElementById('featured-listing-card');
    const freeRadio = document.getElementById('id_listing_type_0');
    const featuredRadio = document.getElementById('id_listing_type_1');
    const submitBtn = document.getElementById('submit-btn');

    // Update card styles based on selection
    function updateCardStyles() {
        if (freeCard && featuredCard && freeRadio && featuredRadio) {
            if (freeRadio.checked) {
                freeCard.classList.add('selected');
                featuredCard.classList.remove('selected');
            } else {
                featuredCard.classList.add('selected');
                freeCard.classList.remove('selected');
            }
        }
    }

    // Update submit button text
    function updateSubmitButton() {
        if (submitBtn) {
            if (featuredRadio && featuredRadio.checked) {
                submitBtn.innerHTML = '<i class="fa fa-crown"></i>Submit Featured Listing (KES 1,000)';
            } else {
                submitBtn.innerHTML = '<i class="fa fa-paper-plane"></i>Submit Property Listing';
            }
        }
    }

    // Add click handlers to cards
    if (freeCard && freeRadio) {
        freeCard.addEventListener('click', function() {
            freeRadio.checked = true;
            updateCardStyles();
            updateSubmitButton();
        });
    }

    if (featuredCard && featuredRadio) {
        featuredCard.addEventListener('click', function() {
            featuredRadio.checked = true;
            updateCardStyles();
            updateSubmitButton();
        });
    }

    // Add change handlers to radio buttons
    if (freeRadio) {
        freeRadio.addEventListener('change', function() {
            updateCardStyles();
            updateSubmitButton();
        });
    }

    if (featuredRadio) {
        featuredRadio.addEventListener('change', function() {
            updateCardStyles();
            updateSubmitButton();
        });
    }

    // Initialize styles
    updateCardStyles();
    updateSubmitButton();

    // Form validation
    inputs.forEach(input => {
        input.addEventListener('blur', function() {
            if (this.checkValidity()) {
                this.classList.remove('is-invalid');
                this.classList.add('is-valid');
            } else {
                this.classList.remove('is-valid');
                this.classList.add('is-invalid');
            }
        });

        input.addEventListener('input', function() {
            if (this.checkValidity()) {
                this.classList.remove('is-invalid');
                this.classList.add('is-valid');
            }
        });
    });

    // Form submission handler
    form.addEventListener('submit', function(e) {
        // Validate required fields
        let isValid = true;
        inputs.forEach(input => {
            if (input.required && !input.value.trim()) {
                input.classList.add('is-invalid');
                isValid = false;
            }
        });

        if (!isValid) {
            e.preventDefault();
            alert('Please fill in all required fields marked with *');
            return;
        }

        // Show loading state
        if (submitBtn) {
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="fa fa-spinner fa-spin"></i>Submitting...';
            submitBtn.disabled = true;

            // Re-enable button after 5 seconds in case submission fails
            setTimeout(() => {
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }, 5000);
        }
    });

    // Image preview for file inputs
    const fileInputs = form.querySelectorAll('input[type="file"]');
    fileInputs.forEach(input => {
        input.addEventListener('change', function() {
            const parent = this.closest('.photo-upload-item');
            if (parent) {
                const fileInfo = parent.querySelector('.upload-info span');
                if (fileInfo && this.files.length > 0) {
                    const fileName = this.files[0].name;
                    if (fileName.length > 20) {
                        fileInfo.textContent = fileName.substring(0, 17) + '...';
                    } else {
                        fileInfo.textContent = fileName;
                    }
                }
            }
        });
    });

    // Add focus effects to form controls
    inputs.forEach(input => {
        input.addEventListener('focus', function() {
            this.parentElement.style.transform = 'translateY(-2px)';
        });

        input.addEventListener('blur', function() {
            this.parentElement.style.transform = 'translateY(0)';
        });
    });

    // Auto-hide success message after 8 seconds
    setTimeout(() => {
        const alerts = document.querySelectorAll('.alert-success-custom');
        alerts.forEach(alert => {
            alert.style.opacity = '0';
            alert.style.transform = 'translateY(-20px) scale(0.95)';
            setTimeout(() => {
                alert.style.display = 'none';
            }, 300);
        });
    }, 8000);

    // Scroll to top if there's a success message
    {% if messages %}
        window.scrollTo({ top: 0, behavior: 'smooth' });
    {% endif %}
});
</script>
{% endblock %}
{% extends "base.html" %}
{% load static %}
{% block content %}
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile - BnB Ke</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
        --glass-white: rgba(255, 255, 255, 0.95);
        --glass-light: rgba(255, 255, 255, 0.85);
        --glass-medium: rgba(255, 255, 255, 0.75);
        --glass-dark: rgba(255, 255, 255, 0.65);
        --glass-border: rgba(255, 255, 255, 0.25);
        --glass-shadow: 0 20px 40px rgba(0, 0, 0, 0.08);
        --blur-intensity: blur(20px);
        --border-radius: 16px;
        --primary-gradient: linear-gradient(135deg, rgb(255, 0, 0), rgb(255, 107, 53));
        --secondary-gradient: linear-gradient(135deg, #10b981 0%, #059669 100%);
        --text-primary: #2d3748;
        --text-secondary: #4a5568;
        --text-muted: #718096;
        --success-color: #10b981;
        --error-color: #ef4444;
        --warning-color: #f59e0b;
    }

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
        min-height: 100vh;
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        padding: 16px;
        color: var(--text-primary);
        font-size: 16px;
        line-height: 1.5;
    }

    .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 8px;
    }

    .glass-shapes {
        position: fixed;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 0;
    }

    .shape {
        position: absolute;
        background: linear-gradient(45deg, rgba(139, 92, 246, 0.1), rgba(99, 102, 241, 0.1));
        border-radius: 50%;
        filter: blur(40px);
        animation: float 20s infinite linear;
    }

    .shape-1 {
        width: 200px;
        height: 200px;
        top: -100px;
        right: -100px;
    }

    .shape-2 {
        width: 150px;
        height: 150px;
        bottom: -75px;
        left: -75px;
        animation-delay: -10s;
        background: linear-gradient(45deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.1));
    }

    /* Messages */
    .messages-container {
        position: fixed;
        top: 16px;
        left: 16px;
        right: 16px;
        z-index: 1000;
        max-width: 400px;
        margin: 0 auto;
    }

    .alert {
        padding: 1rem;
        background: var(--glass-white);
        backdrop-filter: blur(20px);
        border-radius: 12px;
        margin-bottom: 0.75rem;
        border-left: 4px solid;
        box-shadow: var(--glass-shadow);
        animation: slideInRight 0.5s ease-out;
        display: flex;
        align-items: flex-start;
        gap: 1rem;
        font-size: 0.95rem;
        line-height: 1.4;
    }

    .alert i {
        font-size: 1.2rem;
        flex-shrink: 0;
        margin-top: 0.125rem;
    }

    .alert.success {
        border-left-color: var(--success-color);
        background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.05));
    }

    .alert.error {
        border-left-color: var(--error-color);
        background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(220, 38, 38, 0.05));
    }

    .alert.info {
        border-left-color: #3b82f6;
        background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(37, 99, 235, 0.05));
    }

    .alert.warning {
        border-left-color: var(--warning-color);
        background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(217, 119, 6, 0.05));
    }

    .alert ul {
        margin-top: 0.5rem;
        padding-left: 1.25rem;
    }

    .alert li {
        margin-bottom: 0.25rem;
    }

    /* Profile Header */
    .profile-header {
        position: relative;
        z-index: 1;
        margin-bottom: 1.5rem;
        animation: slideUp 0.8s ease-out;
    }

    .profile-header-glass {
        background: var(--glass-white);
        backdrop-filter: var(--blur-intensity);
        -webkit-backdrop-filter: var(--blur-intensity);
        border-radius: var(--border-radius);
        border: 1px solid var(--glass-border);
        box-shadow: var(--glass-shadow);
        padding: 1.5rem;
        position: relative;
        overflow: hidden;
    }

    .profile-header-glass::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 3px;

    }

    .profile-info {
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
        gap: 1.5rem;
        margin-bottom: 1.5rem;
    }

    .profile-avatar {
        position: relative;
    }

    .avatar-circle {
        width: 100px;
        height: 100px;
        background: var(--glass-light);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        border: 2px solid var(--glass-border);
        overflow: hidden;
        position: relative;
    }

    .avatar-circle img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .avatar-circle i {
        font-size: 2.5rem;
        background: var(--primary-gradient);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    .avatar-edit {
        position: absolute;
        bottom: 0;
        right: 0;
        width: 32px;
        height: 32px;
        background: var(--glass-white);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        border: 2px solid var(--glass-border);
        cursor: pointer;
        color: var(--text-primary);
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }

    .avatar-edit:hover {
        background: var(--glass-light);
        transform: scale(1.1);
    }

    .profile-details {
        width: 100%;
    }

    .profile-name {
        font-size: 1.5rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
        background: var(--primary-gradient);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        line-height: 1.3;
    }

    .profile-email {
        color: var(--text-secondary);
        font-size: 0.95rem;
        margin-bottom: 0.75rem;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
        flex-wrap: wrap;
    }

    .profile-email i {
        color: var(--text-muted);
    }

    .profile-badge {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.5rem 1rem;
        background: var(--glass-light);
        border-radius: 20px;
        font-size: 0.85rem;
        margin: 0.5rem 0;
        color: var(--text-secondary);
    }

    .profile-badge.host {
        background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.05));
        color: #059669;
        border: 1px solid rgba(5, 150, 105, 0.2);
    }

    .profile-stats {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 1rem;
        margin-top: 1rem;
    }

    .stat-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 1rem;
        background: var(--glass-light);
        border-radius: 12px;
        border: 1px solid var(--glass-border);
        transition: all 0.3s ease;
        cursor: pointer;
        min-height: 80px;
    }

    .stat-item:hover {
        background: var(--glass-white);
        transform: translateY(-3px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);
    }

    .stat-number {
        font-size: 1.5rem;
        font-weight: 700;
        background: var(--primary-gradient);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        line-height: 1;
    }

    .stat-label {
        color: var(--text-secondary);
        font-size: 0.85rem;
        margin-top: 0.5rem;
        text-align: center;
        line-height: 1.2;
    }

    /* Main Content */
    .profile-content {
        display: grid;
        grid-template-columns: 1fr;
        gap: 1.5rem;
        position: relative;
        z-index: 1;
    }

    /* Sidebar */
    .profile-sidebar {
        width: 100%;
    }

    .sidebar-glass {
        background: var(--glass-white);
        backdrop-filter: var(--blur-intensity);
        -webkit-backdrop-filter: var(--blur-intensity);
        border-radius: var(--border-radius);
        border: 1px solid var(--glass-border);
        box-shadow: var(--glass-shadow);
        padding: 1.25rem;
    }

    .nav-menu {
        list-style: none;
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 0.5rem;
    }

    .nav-item {
        margin-bottom: 0;
    }

    .nav-link {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 0.5rem;
        padding: 0.75rem;
        color: var(--text-secondary);
        text-decoration: none;
        border-radius: 12px;
        transition: all 0.3s ease;
        font-weight: 500;
        font-size: 0.85rem;
        text-align: center;
        height: 100%;
    }

    .nav-link i {
        font-size: 1.25rem;
        color: var(--text-muted);
    }

    .nav-link:hover, .nav-link.active {
        background: var(--glass-light);
        color: var(--text-primary);
    }

    .nav-link:hover i, .nav-link.active i {
        color: #8b5cf6;
    }

    /* Content Area */
    .content-area {
        display: grid;
        gap: 1.5rem;
    }

    .content-card {
        background: var(--glass-white);
        backdrop-filter: var(--blur-intensity);
        -webkit-backdrop-filter: var(--blur-intensity);
        border-radius: var(--border-radius);
        border: 1px solid var(--glass-border);
        box-shadow: var(--glass-shadow);
        padding: 1.5rem;
        animation: fadeIn 0.6s ease-out;
    }

    .card-header {
        display: flex;
        flex-direction: column;
        align-items: stretch;
        gap: 1rem;
        margin-bottom: 1.5rem;
        padding-bottom: 1rem;
        border-bottom: 1px solid var(--glass-border);
    }

    .card-title {
        font-size: 1.3rem;
        font-weight: 700;
        color: var(--text-primary);
        display: flex;
        align-items: center;
        gap: 0.75rem;
        line-height: 1.3;
    }

    .card-title i {
        background: var(--primary-gradient);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    /* My Listings */
    .listings-grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: 1.25rem;
    }

    .listing-card {
        background: var(--glass-light);
        border-radius: 16px;
        border: 1px solid var(--glass-border);
        overflow: hidden;
        transition: all 0.3s ease;
    }

    .listing-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
    }

    .listing-image {
        height: 160px;
        background: var(--glass-medium);
        position: relative;
        overflow: hidden;
    }

    .listing-image img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform 0.3s ease;
    }

    .listing-card:hover .listing-image img {
        transform: scale(1.05);
    }

    .listing-status {
        position: absolute;
        top: 0.75rem;
        right: 0.75rem;
        background: var(--glass-white);
        padding: 0.25rem 0.75rem;
        border-radius: 20px;
        font-size: 0.75rem;
        font-weight: 600;
        backdrop-filter: blur(10px);
        max-width: 120px;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
    }

    .listing-status.approved {
        background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.1));
        color: #059669;
    }

    .listing-status.pending {
        background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(217, 119, 6, 0.1));
        color: #d97706;
    }

    .listing-status.featured {
        background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(99, 102, 241, 0.1));
        color: #8b5cf6;
    }

    .listing-content {
        padding: 1.25rem;
    }

    .listing-title {
        font-size: 1.1rem;
        font-weight: 600;
        margin-bottom: 0.5rem;
        color: var(--text-primary);
        line-height: 1.3;
    }

    .listing-meta {
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        gap: 0.75rem;
        margin-bottom: 1rem;
        color: var(--text-secondary);
        font-size: 0.85rem;
    }

    .listing-price {
        color: #059669;
        font-weight: 700;
        font-size: 1.1rem;
    }

    .listing-actions {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 0.5rem;
        margin-top: 1rem;
    }

    .action-btn {
        padding: 0.5rem;
        background: var(--glass-white);
        border: 1px solid var(--glass-border);
        border-radius: 8px;
        color: var(--text-secondary);
        font-size: 0.85rem;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
        text-decoration: none;
        height: 40px;
    }

    .action-btn:hover {
        background: var(--glass-light);
        color: var(--text-primary);
    }

    .action-btn.edit:hover {
        color: #8b5cf6;
    }

    .action-btn.delete:hover {
        color: #e53e3e;
    }

    /* Empty State */
    .empty-state {
        text-align: center;
        padding: 2rem 1rem;
        color: var(--text-muted);
    }

    .empty-state i {
        font-size: 2.5rem;
        margin-bottom: 1rem;
        opacity: 0.5;
    }

    /* Forms */
    .form-grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: 1.25rem;
    }

    .form-group {
        margin-bottom: 1.25rem;
    }

    .form-group.full-width {
        grid-column: 1 / -1;
    }

    .form-label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: 600;
        color: var(--text-primary);
        font-size: 0.95rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        line-height: 1.3;
    }

    .form-input, .form-textarea, .form-select {
        width: 100%;
        padding: 1rem;
        background: var(--glass-light);
        backdrop-filter: blur(10px);
        border: 1px solid var(--glass-border);
        border-radius: 12px;
        font-size: 1rem;
        color: var(--text-primary);
        transition: all 0.3s ease;
        min-height: 52px;
    }

    .form-input:focus, .form-textarea:focus, .form-select:focus {
        outline: none;
        background: var(--glass-white);
        border-color: rgba(139, 92, 246, 0.3);
        box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
        transform: translateY(-2px);
    }

    .form-input.error, .form-textarea.error, .form-select.error {
        border-color: var(--error-color);
    }

    .form-textarea {
        min-height: 120px;
        resize: vertical;
    }

    .form-error {
        display: block;
        margin-top: 0.5rem;
        color: var(--error-color);
        font-size: 0.85rem;
        padding-left: 0.5rem;
        border-left: 2px solid var(--error-color);
        line-height: 1.3;
    }

    .checkbox-group {
        display: flex;
        align-items: flex-start;
        gap: 0.75rem;
        margin-bottom: 1rem;
    }

    .checkbox-wrapper {
        position: relative;
        margin-top: 0.25rem;
        flex-shrink: 0;
    }

    .checkbox-input {
        position: absolute;
        opacity: 0;
        width: 0;
        height: 0;
    }

    .checkbox-custom {
        width: 20px;
        height: 20px;
        background: var(--glass-white);
        border: 1px solid var(--glass-border);
        border-radius: 6px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .checkbox-input:checked + .checkbox-custom {
        background: var(--primary-gradient);
        border-color: transparent;
    }

    .checkbox-input:checked + .checkbox-custom::after {
        content: '✓';
        color: white;
        font-size: 0.8rem;
        font-weight: bold;
    }

    .checkbox-label {
        color: var(--text-secondary);
        font-size: 0.95rem;
        cursor: pointer;
        line-height: 1.4;
    }

    .btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 0.75rem;
        padding: 0.875rem 1.5rem;
        background: var(--primary-gradient);
        color: white;
        border: none;
        border-radius: 12px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        text-decoration: none;
        min-height: 52px;
        width: 100%;
    }

    .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 25px rgba(139, 92, 246, 0.3);
    }

    .btn.secondary {
        background: var(--glass-light);
        color: var(--text-primary);
    }

    .btn.danger {
        background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
    }

    /* Bookings Table */
    .bookings-table {
        width: 100%;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
    }

    .bookings-table table {
        width: 100%;
        min-width: 600px;
        border-collapse: collapse;
    }

    .bookings-table th {
        padding: 0.75rem;
        text-align: left;
        background: var(--glass-light);
        color: var(--text-primary);
        font-weight: 600;
        font-size: 0.9rem;
        white-space: nowrap;
    }

    .bookings-table td {
        padding: 0.75rem;
        border-bottom: 1px solid var(--glass-border);
        color: var(--text-secondary);
        font-size: 0.9rem;
    }

    .status-badge {
        padding: 0.25rem 0.75rem;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 600;
        display: inline-block;
        white-space: nowrap;
    }

    /* Animations */
    @keyframes float {
        0% { transform: translate(0, 0) rotate(0deg); }
        100% { transform: translate(50px, 50px) rotate(360deg); }
    }

    @keyframes slideUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @keyframes fadeIn {
        from {
            opacity: 0;
        }
        to {
            opacity: 1;
        }
    }

    @keyframes slideInRight {
        from {
            opacity: 0;
            transform: translateX(30px);
        }
        to {
            opacity: 1;
            transform: translateX(0);
        }
    }

    /* Responsive Breakpoints */

    /* Small tablets and large phones (600px and up) */
    @media (min-width: 600px) {
        .container {
            padding: 0 16px;
        }

        .messages-container {
            left: auto;
            right: 16px;
            max-width: 400px;
        }

        .profile-info {
            flex-direction: row;
            text-align: left;
            align-items: center;
        }

        .profile-details {
            flex: 1;
        }

        .profile-email {
            justify-content: flex-start;
        }

        .profile-badge {
            margin: 0 0 0 1rem;
        }

        .profile-stats {
            grid-template-columns: repeat(4, 1fr);
        }

        .stat-item {
            min-height: 90px;
        }

        .stat-number {
            font-size: 1.75rem;
        }

        .nav-menu {
            grid-template-columns: 1fr;
        }

        .listings-grid {
            grid-template-columns: repeat(2, 1fr);
        }

        .card-header {
            flex-direction: row;
            align-items: center;
            justify-content: space-between;
        }

        .card-title {
            font-size: 1.5rem;
        }

        .btn {
            width: auto;
        }

        .form-grid {
            grid-template-columns: 1fr 1fr;
        }
    }

    /* Tablets (768px and up) */
    @media (min-width: 768px) {
        body {
            padding: 24px;
        }

        .container {
            padding: 0 20px;
        }

        .profile-header-glass {
            padding: 2rem;
        }

        .content-card {
            padding: 2rem;
        }

        .avatar-circle {
            width: 120px;
            height: 120px;
        }

        .avatar-circle i {
            font-size: 3.5rem;
        }

        .profile-name {
            font-size: 2rem;
        }

        .listings-grid {
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        .listing-actions {
            grid-template-columns: repeat(3, 1fr);
        }

        .profile-content {
            grid-template-columns: 280px 1fr;
            gap: 2rem;
        }

        .profile-sidebar {
            position: sticky;
            top: 2rem;
            height: fit-content;
        }

        .nav-menu {
            display: block;
        }

        .nav-item {
            margin-bottom: 0.5rem;
        }

        .nav-link {
            flex-direction: row;
            justify-content: flex-start;
            padding: 1rem;
            font-size: 0.95rem;
            text-align: left;
        }

        .form-grid {
            gap: 1.5rem;
        }
    }

    /* Desktop (1024px and up) */
    @media (min-width: 1024px) {
        .container {
            padding: 0 24px;
        }

        .messages-container {
            right: 24px;
        }

        .profile-name {
            font-size: 2.2rem;
        }

        .stat-number {
            font-size: 2rem;
        }

        .card-title {
            font-size: 1.8rem;
        }
    }

    /* Small phones (480px and below) */
    @media (max-width: 480px) {
        body {
            padding: 12px;
            font-size: 14px;
        }

        .container {
            padding: 0 8px;
        }

        .profile-header-glass {
            padding: 1.25rem;
        }

        .avatar-circle {
            width: 90px;
            height: 90px;
        }

        .avatar-circle i {
            font-size: 2rem;
        }

        .avatar-edit {
            width: 28px;
            height: 28px;
            font-size: 0.9rem;
        }

        .profile-name {
            font-size: 1.3rem;
        }

        .profile-email {
            font-size: 0.9rem;
        }

        .profile-stats {
            gap: 0.75rem;
        }

        .stat-item {
            padding: 0.75rem;
            min-height: 70px;
        }

        .stat-number {
            font-size: 1.25rem;
        }

        .stat-label {
            font-size: 0.8rem;
        }

        .content-card {
            padding: 1.25rem;
        }

        .card-header {
            gap: 0.75rem;
        }

        .card-title {
            font-size: 1.2rem;
        }

        .listing-image {
            height: 140px;
        }

        .listing-content {
            padding: 1rem;
        }

        .listing-title {
            font-size: 1rem;
        }

        .listing-meta {
            font-size: 0.8rem;
            gap: 0.5rem;
        }

        .listing-price {
            font-size: 1rem;
        }

        .form-input, .form-textarea, .form-select {
            padding: 0.875rem;
            font-size: 15px;
            min-height: 48px;
        }

        .form-textarea {
            min-height: 100px;
        }

        .btn {
            padding: 0.75rem 1.25rem;
            font-size: 0.95rem;
            min-height: 48px;
        }

        .nav-link {
            padding: 0.625rem;
            font-size: 0.8rem;
        }

        .nav-link i {
            font-size: 1.1rem;
        }

        .alert {
            padding: 0.875rem;
            font-size: 0.9rem;
        }
    }

    /* Medium phones (481px to 599px) */
    @media (min-width: 481px) and (max-width: 599px) {
        .profile-info {
            gap: 1.25rem;
        }

        .avatar-circle {
            width: 100px;
            height: 100px;
        }

        .profile-name {
            font-size: 1.5rem;
        }

        .listings-grid {
            grid-template-columns: 1fr;
        }

        .nav-menu {
            grid-template-columns: repeat(3, 1fr);
        }
    }

    /* Touch device optimizations */
    @media (hover: none) and (pointer: coarse) {
        .avatar-edit:hover {
            transform: none;
        }

        .stat-item:hover,
        .listing-card:hover,
        .nav-link:hover,
        .action-btn:hover,
        .btn:hover {
            transform: none;
        }

        /* Increase touch target sizes */
        .avatar-edit,
        .action-btn,
        .nav-link,
        .btn {
            min-height: 44px;
            min-width: 44px;
        }

        .checkbox-custom {
            min-width: 24px;
            min-height: 24px;
        }

        .form-input,
        .form-textarea,
        .form-select {
            font-size: 16px; /* Prevents zoom on iOS */
            padding: 16px;
        }

        .listing-actions {
            gap: 0.75rem;
        }
    }

    /* High-resolution displays */
    @media (min-resolution: 192dpi) {
        .profile-header-glass,
        .sidebar-glass,
        .content-card,
        .alert {
            backdrop-filter: var(--blur-intensity) saturate(180%);
        }
    }

    /* Reduced motion preference */
    @media (prefers-reduced-motion: reduce) {
        *,
        *::before,
        *::after {
            animation-duration: 0.01ms !important;
            animation-iteration-count: 1 !important;
            transition-duration: 0.01ms !important;
        }
    }

    /* Print styles */
    @media print {
        .glass-shapes,
        .profile-header-glass::before,
        .avatar-edit,
        .btn,
        .nav-link i {
            display: none;
        }

        .profile-header-glass,
        .sidebar-glass,
        .content-card {
            border: 1px solid #ddd;
            box-shadow: none;
            background: white;
        }

        .form-input,
        .form-textarea,
        .form-select {
            background: white;
            border: 1px solid #ccc;
        }

        .checkbox-custom {
            background: white;
            border: 1px solid #ccc;
        }
    }
</style>
</head>
<body>
    <div class="glass-shapes">
        <div class="shape shape-1"></div>
        <div class="shape shape-2"></div>
    </div>

    <!-- Messages Container -->
    {% if messages %}
    <div class="messages-container">
        {% for message in messages %}
        <div class="alert {{ message.tags }}">
            {% if message.tags == 'success' %}
                <i class="fas fa-check-circle"></i>
            {% elif message.tags == 'error' %}
                <i class="fas fa-exclamation-circle"></i>
            {% elif message.tags == 'warning' %}
                <i class="fas fa-exclamation-triangle"></i>
            {% else %}
                <i class="fas fa-info-circle"></i>
            {% endif %}
            <span>{{ message }}</span>
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <div class="container">
        <!-- Profile Header -->
        <div class="profile-header">
            <div class="profile-header-glass">
                <div class="profile-info">
                    <div class="profile-avatar">
                        <div class="avatar-circle">
                            {% if user.profile.profile_picture %}
                                <img src="{{ user.profile.profile_picture.url }}" alt="{{ user.username }}">
                            {% else %}
                                <i class="fas fa-user"></i>
                            {% endif %}
                        </div>
                        <div class="avatar-edit" onclick="document.getElementById('profilePicture').click()">
                            <i class="fas fa-camera"></i>
                        </div>
                        <form id="pictureForm" method="post" enctype="multipart/form-data" style="display: none;">
                            {% csrf_token %}
                            <input type="hidden" name="form_type" value="profile_picture">
                            <input type="file" id="profilePicture" name="profile_picture" accept="image/*" onchange="handleProfilePictureUpload()">
                        </form>
                    </div>

                    <div class="profile-details">
                        <h1 class="profile-name">{{ user.get_full_name|default:user.username }}</h1>
                        <div class="profile-email">
                            <i class="fas fa-envelope"></i>
                            {{ user.email }}
                            {% if user.profile.is_host %}
                            <span class="profile-badge host">
                                <i class="fas fa-crown"></i>
                                Verified Host
                            </span>
                            {% endif %}
                        </div>
                        <div class="profile-email">
                            <i class="fas fa-phone"></i>
                            {{ user.profile.phone|default:"No phone number set" }}
                        </div>
                        {% if user.profile.whatsapp %}
                        <div class="profile-email">
                            <i class="fab fa-whatsapp"></i>
                            {{ user.profile.whatsapp }}
                        </div>
                        {% endif %}
                    </div>
                </div>

                <div class="profile-stats">
                    <div class="stat-item" onclick="switchTab('listings')">
                        <span class="stat-number">{{ user.user_listings.count }}</span>
                        <span class="stat-label">Listings</span>
                    </div>
                    <div class="stat-item" onclick="switchTab('bookings')">
                        <span class="stat-number">{{ user.user_bookings.count }}</span>
                        <span class="stat-label">Bookings</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number">{{ approved_listings_count }}</span>
                        <span class="stat-label">Approved</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number">{{ user.date_joined|date:"M Y" }}</span>
                        <span class="stat-label">Member Since</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="profile-content">
            <!-- Sidebar -->
            <div class="profile-sidebar">
                <div class="sidebar-glass">
                    <ul class="nav-menu">
                        <li class="nav-item">
                            <a href="#my-listings" class="nav-link active" data-tab="listings">
                                <i class="fas fa-home"></i>
                                My Listings
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#edit-profile" class="nav-link" data-tab="profile">
                                <i class="fas fa-user-edit"></i>
                                Edit Profile
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#bookings" class="nav-link" data-tab="bookings">
                                <i class="fas fa-calendar-check"></i>
                                My Bookings
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#settings" class="nav-link" data-tab="settings">
                                <i class="fas fa-cog"></i>
                                Settings
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="{% url 'advertise_bnb' %}" class="nav-link">
                                <i class="fas fa-plus-circle"></i>
                                New Listing
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="{% url 'logout' %}" class="nav-link">
                                <i class="fas fa-sign-out-alt"></i>
                                Logout
                            </a>
                        </li>
                    </ul>
                </div>
            </div>

            <!-- Content Area -->
            <div class="content-area">
                <!-- My Listings Tab -->
                <div class="content-card" id="listings-tab">
                    <div class="card-header">
                        <h2 class="card-title">
                            <i class="fas fa-home"></i>
                            My Listings
                        </h2>
                        <a href="{% url 'advertise_bnb' %}" class="btn">
                            <i class="fas fa-plus"></i>
                            New Listing
                        </a>
                    </div>

                    {% if user.user_listings.all %}
                    <div class="listings-grid">
                        {% for listing in user.user_listings.all %}
                        <div class="listing-card">
                            <div class="listing-image">
                                {% if listing.main_image %}
                                <img src="{{ listing.main_image.url }}" alt="{{ listing.title }}">
                                {% else %}
                                <div style="width: 100%; height: 100%; background: var(--glass-medium); display: flex; align-items: center; justify-content: center;">
                                    <i class="fas fa-home fa-2x" style="color: var(--text-muted);"></i>
                                </div>
                                {% endif %}
                                <span class="listing-status {% if listing.is_approved %}approved{% else %}pending{% endif %} {% if listing.listing_type == 'featured' %}featured{% endif %}">
                                    {% if listing.listing_type == 'featured' %}⭐ {% endif %}
                                    {{ listing.is_approved|yesno:"Approved,Pending" }}
                                </span>
                            </div>
                            <div class="listing-content">
                                <h3 class="listing-title">{{ listing.title|truncatechars:40 }}</h3>
                                <div class="listing-meta">
                                    <span><i class="fas fa-map-marker-alt"></i> {{ listing.get_location_display }}</span>
                                    <span><i class="fas fa-users"></i> {{ listing.guests }}</span>
                                </div>
                                <div class="listing-price">KES {{ listing.price_per_night }}/night</div>
                                <div class="listing-actions">
                                    <a href="{{ listing.get_absolute_url }}" class="action-btn view">
                                        <i class="fas fa-eye"></i> View
                                    </a>
                                    <a href="{% url 'edit_bnb_listing' listing.id %}" class="action-btn edit">
                                        <i class="fas fa-edit"></i> Edit
                                    </a>
                                    <button class="action-btn delete" onclick="confirmDelete({{ listing.id }})">
                                        <i class="fas fa-trash"></i> Delete
                                    </button>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                    {% else %}
                    <div class="empty-state">
                        <i class="fas fa-home"></i>
                        <h3>No Listings Yet</h3>
                        <p>You haven't created any BnB listings yet.</p>
                        <a href="{% url 'advertise_bnb' %}" class="btn" style="margin-top: 1rem;">
                            <i class="fas fa-plus"></i>
                            Create Your First Listing
                        </a>
                    </div>
                    {% endif %}
                </div>

                <!-- Edit Profile Tab -->
                <div class="content-card" id="profile-tab" style="display: none;">
                    <div class="card-header">
                        <h2 class="card-title">
                            <i class="fas fa-user-edit"></i>
                            Edit Profile
                        </h2>
                    </div>

                    <form method="post" enctype="multipart/form-data" id="profileForm">
                        {% csrf_token %}
                        <input type="hidden" name="form_type" value="profile_update">

                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-user"></i>
                                    First Name
                                </label>
                                <input type="text" name="first_name" class="form-input {% if u_form.first_name.errors %}error{% endif %}"
                                       value="{{ u_form.first_name.value|default:user.first_name }}">
                                {% if u_form.first_name.errors %}
                                    <span class="form-error">{{ u_form.first_name.errors.0 }}</span>
                                {% endif %}
                            </div>

                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-user"></i>
                                    Last Name
                                </label>
                                <input type="text" name="last_name" class="form-input {% if u_form.last_name.errors %}error{% endif %}"
                                       value="{{ u_form.last_name.value|default:user.last_name }}">
                                {% if u_form.last_name.errors %}
                                    <span class="form-error">{{ u_form.last_name.errors.0 }}</span>
                                {% endif %}
                            </div>

                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-envelope"></i>
                                    Email
                                </label>
                                <input type="email" name="email" class="form-input {% if u_form.email.errors %}error{% endif %}"
                                       value="{{ u_form.email.value|default:user.email }}" required>
                                {% if u_form.email.errors %}
                                    <span class="form-error">{{ u_form.email.errors.0 }}</span>
                                {% endif %}
                            </div>

                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-phone"></i>
                                    Phone Number
                                </label>
                                <input type="tel" name="phone" class="form-input {% if p_form.phone.errors %}error{% endif %}"
                                       value="{{ p_form.phone.value|default:user.profile.phone }}">
                                {% if p_form.phone.errors %}
                                    <span class="form-error">{{ p_form.phone.errors.0 }}</span>
                                {% endif %}
                            </div>

                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fab fa-whatsapp"></i>
                                    WhatsApp Number
                                </label>
                                <input type="tel" name="whatsapp" class="form-input {% if p_form.whatsapp.errors %}error{% endif %}"
                                       value="{{ p_form.whatsapp.value|default:user.profile.whatsapp }}">
                                {% if p_form.whatsapp.errors %}
                                    <span class="form-error">{{ p_form.whatsapp.errors.0 }}</span>
                                {% endif %}
                            </div>

                            <div class="form-group full-width">
                                <label class="form-label">
                                    <i class="fas fa-comment"></i>
                                    Bio
                                </label>
                                <textarea name="bio" class="form-input form-textarea {% if p_form.bio.errors %}error{% endif %}">{{ p_form.bio.value|default:user.profile.bio }}</textarea>
                                {% if p_form.bio.errors %}
                                    <span class="form-error">{{ p_form.bio.errors.0 }}</span>
                                {% endif %}
                            </div>

                            <div class="form-group full-width">
                                <div class="checkbox-group">
                                    <div class="checkbox-wrapper">
                                        <input type="checkbox" id="is_host" name="is_host" class="checkbox-input" {% if p_form.is_host.value or user.profile.is_host %}checked{% endif %}>
                                        <span class="checkbox-custom"></span>
                                    </div>
                                    <label for="is_host" class="checkbox-label">
                                        I am a property host and want to list my properties
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div style="margin-top: 2rem; display: flex; gap: 1rem; flex-wrap: wrap;">
                            <button type="submit" class="btn" id="saveProfileBtn">
                                <i class="fas fa-save"></i>
                                Save Changes
                            </button>
                            <button type="button" class="btn secondary" onclick="switchTab('listings')">
                                <i class="fas fa-times"></i>
                                Cancel
                            </button>

                        </div>
                    </form>
                </div>

                <!-- My Bookings Tab -->
                <div class="content-card" id="bookings-tab" style="display: none;">
                    <div class="card-header">
                        <h2 class="card-title">
                            <i class="fas fa-calendar-check"></i>
                            My Bookings
                        </h2>
                    </div>

                    {% if user.user_bookings.all %}
                        <div style="overflow-x: auto;">
                            <table style="width: 100%; border-collapse: collapse;">
                                <thead>
                                    <tr style="background: var(--glass-light);">
                                        <th style="padding: 1rem; text-align: left;">Property</th>
                                        <th style="padding: 1rem; text-align: left;">Dates</th>
                                        <th style="padding: 1rem; text-align: left;">Guests</th>
                                        <th style="padding: 1rem; text-align: left;">Total</th>
                                        <th style="padding: 1rem; text-align: left;">Status</th>
                                        <th style="padding: 1rem; text-align: left;">Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for booking in user.user_bookings.all|slice:":5" %}
                                    <tr style="border-bottom: 1px solid var(--glass-border);">
                                        <td style="padding: 1rem;">{{ booking.listing.title }}</td>
                                        <td style="padding: 1rem;">
                                            {{ booking.check_in|date:"M d" }} - {{ booking.check_out|date:"M d" }}
                                        </td>
                                        <td style="padding: 1rem;">{{ booking.number_of_guests }}</td>
                                        <td style="padding: 1rem;">KES {{ booking.total_price }}</td>
                                        <td style="padding: 1rem;">
                                            <span style="padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;
                                                  background: {% if booking.status == 'confirmed' %}var(--success-color){% elif booking.status == 'pending' %}var(--warning-color){% else %}var(--error-color){% endif %};
                                                  color: white;">
                                                {{ booking.get_status_display }}
                                            </span>
                                        </td>
                                        <td style="padding: 1rem;">
                                            <button class="action-btn" onclick="viewBooking({{ booking.id }})">
                                                <i class="fas fa-eye"></i>
                                            </button>
                                        </td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                        {% if user.user_bookings.count > 5 %}
                        <div style="text-align: center; margin-top: 2rem;">
                            <a href="#" class="btn secondary">
                                View All Bookings ({{ user.user_bookings.count }})
                            </a>
                        </div>
                        {% endif %}
                    {% else %}
                    <div class="empty-state">
                        <i class="fas fa-calendar-times"></i>
                        <h3>No Bookings Yet</h3>
                        <p>You haven't made any bookings yet.</p>
                        <a href="{% url 'home' %}" class="btn" style="margin-top: 1rem;">
                            <i class="fas fa-search"></i>
                            Browse Properties
                        </a>
                    </div>
                    {% endif %}
                </div>

                <!-- Settings Tab -->
                <div class="content-card" id="settings-tab" style="display: none;">
                    <div class="card-header">
                        <h2 class="card-title">
                            <i class="fas fa-cog"></i>
                            Account Settings
                        </h2>
                    </div>

                    <div class="form-group">
                        <label class="form-label">
                            <i class="fas fa-bell"></i>
                            Notifications
                        </label>
                        <div style="display: flex; flex-direction: column; gap: 1rem; margin-top: 1rem;">
                            <label style="display: flex; align-items: center; gap: 1rem;">
                                <input type="checkbox" id="booking_notifications" checked>
                                <span>Booking notifications</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 1rem;">
                                <input type="checkbox" id="promotional_emails" checked>
                                <span>Promotional emails</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 1rem;">
                                <input type="checkbox" id="newsletter">
                                <span>Newsletter</span>
                            </label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">
                            <i class="fas fa-shield-alt"></i>
                            Security
                        </label>
                        <div style="margin-top: 1rem; display: flex; flex-direction: column; gap: 1rem;">

                            <button class="btn secondary" onclick="showDeleteAccountModal()">
                                <i class="fas fa-trash-alt"></i>
                                Delete Account
                            </button>
                        </div>
                    </div>

                    <div class="form-group" style="margin-top: 3rem; padding-top: 2rem; border-top: 1px solid var(--glass-border);">
                        <h3 style="margin-bottom: 1rem;">Export Data</h3>
                        <button class="btn secondary" onclick="exportUserData()">
                            <i class="fas fa-download"></i>
                            Export My Data
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Delete Account Modal -->
    <div id="deleteAccountModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; align-items: center; justify-content: center;">
        <div style="background: var(--glass-white); backdrop-filter: blur(20px); border-radius: 20px; padding: 2rem; max-width: 500px; width: 90%;">
            <h2 style="margin-bottom: 1rem; color: var(--error-color);"><i class="fas fa-exclamation-triangle"></i> Delete Account</h2>
            <p style="margin-bottom: 1.5rem; color: var(--text-secondary);">Are you sure you want to delete your account? This action cannot be undone. All your listings and data will be permanently removed.</p>
            <div style="display: flex; gap: 1rem; margin-top: 2rem;">
                <button onclick="hideDeleteAccountModal()" class="btn secondary" style="flex: 1;">
                    Cancel
                </button>
                <button onclick="deleteAccount()" class="btn danger" style="flex: 1;">
                    <i class="fas fa-trash"></i>
                    Delete Account
                </button>
            </div>
        </div>
    </div>

    <script>
        // Tab switching functionality
        function switchTab(tabName) {
            // Hide all tabs
            const tabs = ['listings', 'profile', 'bookings', 'settings'];
            tabs.forEach(tab => {
                const tabElement = document.getElementById(`${tab}-tab`);
                if (tabElement) tabElement.style.display = 'none';
            });

            // Show selected tab
            const selectedTab = document.getElementById(`${tabName}-tab`);
            if (selectedTab) selectedTab.style.display = 'block';

            // Update active nav link
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('data-tab') === tabName) {
                    link.classList.add('active');
                }
            });

            // Update URL hash
            window.location.hash = `#${tabName}`;

            // Scroll to top of content
            selectedTab.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // Initialize tab from URL hash
        function initTab() {
            const hash = window.location.hash.substring(1);
            const validTabs = ['listings', 'profile', 'bookings', 'settings'];

            if (hash && validTabs.includes(hash)) {
                switchTab(hash);
            } else {
                switchTab('listings');
            }
        }

        // Add click event to nav links
        document.querySelectorAll('.nav-link[data-tab]').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const tabName = this.getAttribute('data-tab');
                switchTab(tabName);
            });
        });

        // Delete listing confirmation
        function confirmDelete(listingId) {
            if (confirm('Are you sure you want to delete this listing? This action cannot be undone.')) {
                showLoading('Deleting listing...');
                fetch(`/listings/delete/${listingId}/`, {
                    method: 'POST',
                    headers: {
                        'X-CSRFToken': '{{ csrf_token }}',
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: `csrfmiddlewaretoken={{ csrf_token }}`
                })
                .then(response => {
                    if (response.ok) {
                        location.reload();
                    } else {
                        showError('Failed to delete listing');
                    }
                })
                .catch(error => {
                    showError('Network error. Please try again.');
                })
                .finally(() => {
                    hideLoading();
                });
            }
        }

        // Handle profile picture upload
        function handleProfilePictureUpload() {
            const fileInput = document.getElementById('profilePicture');
            const form = document.getElementById('pictureForm');

            if (fileInput.files.length > 0) {
                showLoading('Uploading profile picture...');
                form.submit();
            }
        }

        // Show delete account modal
        function showDeleteAccountModal() {
            document.getElementById('deleteAccountModal').style.display = 'flex';
        }

        // Hide delete account modal
        function hideDeleteAccountModal() {
            document.getElementById('deleteAccountModal').style.display = 'none';
        }

        // Delete account function
        function deleteAccount() {
            if (confirm('This will permanently delete your account and all associated data. Are you absolutely sure?')) {
                showLoading('Deleting account...');
                // Implement account deletion logic here
                setTimeout(() => {
                    hideLoading();
                    alert('Account deletion request submitted. Please check your email for confirmation.');
                    hideDeleteAccountModal();
                }, 1500);
            }
        }

        // View booking details
        function viewBooking(bookingId) {
            window.location.href = `/bookings/${bookingId}/`;
        }

        // Export user data
        function exportUserData() {
            showLoading('Preparing data export...');
            // Implement data export logic here
            setTimeout(() => {
                hideLoading();
                alert('Data export started. You will receive an email with your data shortly.');
            }, 2000);
        }

        // Show loading indicator
        function showLoading(message) {
            let loadingDiv = document.getElementById('loadingOverlay');
            if (!loadingDiv) {
                loadingDiv = document.createElement('div');
                loadingDiv.id = 'loadingOverlay';
                loadingDiv.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(255, 255, 255, 0.9);
                    backdrop-filter: blur(10px);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    z-index: 9999;
                `;
                document.body.appendChild(loadingDiv);
            }

            loadingDiv.innerHTML = `
                <div style="text-align: center;">
                    <div class="spinner" style="width: 50px; height: 50px; border: 3px solid #f3f3f3; border-top: 3px solid #8b5cf6; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 1rem;"></div>
                    <p>${message}</p>
                </div>
            `;
            loadingDiv.style.display = 'flex';

            // Add spin animation
            const style = document.createElement('style');
            style.textContent = `
                @keyframes spin {
                    0% { transform: rotate(0deg); }
                    100% { transform: rotate(360deg); }
                }
            `;
            document.head.appendChild(style);
        }

        // Hide loading indicator
        function hideLoading() {
            const loadingDiv = document.getElementById('loadingOverlay');
            if (loadingDiv) {
                loadingDiv.style.display = 'none';
            }
        }

        // Show error message
        function showError(message) {
            const messagesContainer = document.querySelector('.messages-container') || createMessagesContainer();
            const errorAlert = document.createElement('div');
            errorAlert.className = 'alert error';
            errorAlert.innerHTML = `
                <i class="fas fa-exclamation-circle"></i>
                <span>${message}</span>
            `;
            messagesContainer.appendChild(errorAlert);

            // Remove error after 5 seconds
            setTimeout(() => {
                errorAlert.remove();
            }, 5000);
        }

        // Create messages container if it doesn't exist
        function createMessagesContainer() {
            const container = document.createElement('div');
            container.className = 'messages-container';
            document.body.appendChild(container);
            return container;
        }

        // Auto-hide messages after 5 seconds
        setTimeout(() => {
            const alerts = document.querySelectorAll('.messages-container .alert');
            alerts.forEach(alert => {
                setTimeout(() => {
                    alert.style.opacity = '0';
                    alert.style.transform = 'translateX(30px)';
                    setTimeout(() => alert.remove(), 300);
                }, 5000);
            });
        }, 100);

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            initTab();

            // Add floating animation to stat items
            document.querySelectorAll('.stat-item').forEach(item => {
                item.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-3px)';
                });

                item.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(0)';
                });
            });

            // Form submission handling
            const profileForm = document.getElementById('profileForm');
            if (profileForm) {
                profileForm.addEventListener('submit', function(e) {
                    const saveBtn = document.getElementById('saveProfileBtn');
                    saveBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Saving...';
                    saveBtn.disabled = true;
                });
            }

            // Clear error styling on input
            document.querySelectorAll('.form-input, .form-textarea').forEach(input => {
                input.addEventListener('input', function() {
                    if (this.classList.contains('error')) {
                        this.classList.remove('error');
                        const errorMsg = this.nextElementSibling;
                        if (errorMsg && errorMsg.classList.contains('form-error')) {
                            errorMsg.remove();
                        }
                    }
                });
            });
        });

        // Handle hash changes
        window.addEventListener('hashchange', initTab);

        // Close modal when clicking outside
        document.addEventListener('click', function(e) {
            const modal = document.getElementById('deleteAccountModal');
            if (modal && modal.style.display === 'flex' && e.target === modal) {
                hideDeleteAccountModal();
            }
        });
    </script>
</body>
{% endblock %}